# Program-10
# Implement AdaBoost ensemble method on a given dataset (Iris dataset)

import pandas as pd
import numpy as np
from sklearn.model_selection import train_test_split
from sklearn.ensemble import AdaBoostClassifier
from sklearn.metrics import accuracy_score

# Load dataset
data = pd.read_csv("Iris.csv")
print(data.shape)

# Prepare X and y
data = data.drop(['Id'], axis=1)
X = data.iloc[:, :-1]
y = data.iloc[:, -1]

print("Shape of X is %s and shape of y is %s" % (X.shape, y.shape))

# Class distribution
print("Number of unique species:", y.nunique())
print(y.value_counts())

# Split data
X_train, X_val, y_train, y_val = train_test_split(X, y, test_size=0.25, random_state=42)

# Train AdaBoost
adb = AdaBoostClassifier()
adb_model = adb.fit(X_train, y_train)

print("The accuracy on validation set is:", adb_model.score(X_val, y_val))

# Test prediction
y_pred = adb_model.predict(X_val)
accuracy = accuracy_score(y_val, y_pred)
print(f"The Accuracy of Prediction on Iris Flower is: {accuracy}")

# Display DataFrame
df = pd.DataFrame({'Actual': y_val, 'Predicted': y_pred})
print(df)
